---
title: "Coral_Model"
author: "Sarah Morris & Lindsey Pekurny"
date: "10/14/2020"
output: html_document
---

**Part A**
**Our Consensus Flow Diagram**

```{r echo=FALSE}

knitr::include_graphics('model-coral_0.png')

```
**#3**
**Flow diagram for coral reef system**

```{r echo=FALSE}
knitr::include_graphics('model-coral.png')
```

In this flow diagram, macroalgae grows on top of coral, which is a negative effect for the coral. Coral grows on algal turf, which negatively effects the algal turf. Parrotfish eat the macroalgae, negatively effecting macroalgae. Macroalgae can grow over algal turf, which negatively impacts the algal turf. Parrotfish have an indirect positive effect on coral by eating the algae smothering the coral, and coral has an indirect positive effect on parrotfish by providing a substrate for macroalgae, which parrotfish eat, to grow on. 

```{r echo=FALSE}
read.csv("coral_variables.csv")
```

**# 4: Program the Model**  

  Growth rates for all 4 organisms plotted separately 
  
```{r} 

require(deSolve)
## Loading required package: deSolve

## This first one is for coral. You can change the values as you like and see how coral's growth rate is influenced. I am confused on what 'state' does?

coral_state <- seq(C = .5)
times <- seq(0,100,by=1)

# Parameters
coral_parameters <- c(a = 0.1,g = 0.8, d = 0.44,r = 1, s = 0.49, M = 100, R = 100, C = 0)
coral_paramters <- as.numeric(coral_parameters)

# Parameters
#coral_parameters <- c(a = 0.1,g = 0.8, d = 0.44, r = 1, s = 0.49, M = 100, R = 100)


coral_state <- seq(C = 50)## I think 10 and 50 may be an equilibrium point
times <- seq(0,100,by=1)

# Parameters
coral_parameters <- c(a = 0.1,g = 0.8, d = 0.44, r = 1, s = 0.49, M = 100, R = 100, C = 0)


# Model
coral <- function(t,coral_state,coral_parameters){
  with(as.list(c(coral_state,coral_parameters)),{
       dC <- (r*R*C) - (d*C) - (a*M*C)
      list(c(dC))   
  })}

# Solve model and plot results
out1 <- ode(y = coral_state, times=times, func=coral, parms=coral_parameters)
par(mfrow=c(1,1))
coralplot <- plot(out1[,1],out1[,2],ylab='Coral',xlab='time',las=1, pch = 19)

```


``` {r}
### Algal Turf

turf_state <- seq(R = .5)## I think 10 and 50 may be an equilibrium point
times <- seq(0,100,by=1)

# Parameters
turf_parameters <- c(a = 0.1,g = 0.8, d = 0.44,r = 1, s = 0.49, M = 100, P = 10, C = 0, R = 100)

# Model
turf <- function(t,turf_state,turf_parameters){
  with(as.list(c(turf_state,turf_parameters)),{
       dT <- (P*M/(M+R) - (g*M*R) - (r*R*C) + (d*C))
      list(c(dT))   
  })}

# Solve model and plot results
out1 <- ode(y = turf_state, times=times,func= turf, parms=turf_parameters)
par(mfrow=c(1,1))
plot(out1[,1],out1[,2],ylab='Turf',xlab='time',las=1, pch = 19)

```

``` {r}

### Macro algae

macro_state <- seq(M = .5)
times <- seq(0,100,by=1)

# Parameters
macro_parameters <- c(a = 0.1,g = 0.8, d = 0.44,r = 1, s = 0.49, R = 100, P = 10, C = 0, M = 100)

# Model
macro <- function(t,macro_state,macro_parameters){
  with(as.list(c(macro_state,macro_parameters)),{
       dM <- ((a*M*C) - ((P*M)/(M+R)) + (g*M*R))
      list(c(dM))   
  })}

# Solve model and plot results
out1 <- ode(y = macro_state, times=times,func=macro,parms=macro_parameters)
#par(mfrow=c(1,1))
plot(out1[,1],out1[,2],ylab='Macro',xlab='time',las=1, pch = 19)

```

``` {r}

### Parrotfish

parrot_state <- c(P = .5)
times <- seq(0,100,by=1)

# Parameters
parrot_parameters <- c(a = 0.1,g = 0.8, d = 0.44,r = 1, s = 0.49, R = 100, M = 100, C = 50)

# Model
parrot <- function(t, parrot_state, parrot_parameters){
  with(as.list(c(parrot_state,parrot_parameters)),{
       dP <- (1- (P/(r*R*C)) - (d*C) - (a*M*C))
      list(c(dP))   
  })}

# Solve model and plot results
out1 <- ode(y = parrot_state, times=times, func=parrot, parms= parrot_parameters)
par(mfrow=c(1,1))
plot(out1[,1],out1[,2],ylab='Parrotfish',xlab='time',las=1, pch = 19)


```

**#5**
#Produce figures and design analyses to address the following questions: 
**(a) What are the long-term dynamics of the system with the default parameters given below?**

**(b) What are the most important parameters in determining the long-term dynamics?**
